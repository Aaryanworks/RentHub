<!-- Main Container with light gray background for contrast -->
<div class="min-h-screen bg-gray-50 pb-20">

  <!-- ========================================== -->
  <!-- 1. FEATURED SECTION (Fixed Height & Layout) -->
  <!-- ========================================== -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8">
    
    <!-- Section Header -->
    <div class="mb-6 border-l-4 border-indigo-600 pl-4">
      <h2 class="text-2xl font-bold text-slate-800">Featured Residence</h2>
      <p class="text-slate-500 text-sm">Handpicked properties for your lifestyle</p>
    </div>

    <!-- CAROUSEL CARD: Compact Height (350px desktop, auto mobile) -->
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col md:flex-row h-auto md:h-[320px] relative group" *ngIf="featuredListings.length > 0">
      
      <!-- LEFT: Image Area (55% width) -->
      <div class="w-full md:w-[55%] h-48 md:h-full relative bg-gray-200">
        <img 
          [src]="featuredListings[currentSlideIndex].image" 
          class="w-full h-full object-cover transition-transform duration-700 hover:scale-105"
          alt="Featured Property"
        >
        
        <!-- Image Gradient Overlay -->
        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent md:bg-gradient-to-r md:from-transparent md:to-black/10"></div>

        <!-- Navigation Arrows (Floating) -->
        <div class="absolute inset-0 flex items-center justify-between px-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
          <button (click)="prevSlide()" class="bg-white/90 hover:bg-white text-slate-800 p-3 rounded-full shadow-lg backdrop-blur-sm transition-all transform hover:-translate-x-1 flex items-center">
            <span class="material-icons text-xl block">chevron_left</span>
          </button>
          <button (click)="nextSlide()" class="bg-white/90 hover:bg-white text-slate-800 p-3 rounded-full shadow-lg backdrop-blur-sm transition-all transform hover:translate-x-1 flex items-center">
            <span class="material-icons text-xl block">chevron_right</span>
          </button>
        </div>

        <!-- Pagination Badge -->
        <div class="absolute bottom-6 left-6 bg-black/60 backdrop-blur-md text-white px-4 py-1 rounded-full text-xs font-medium tracking-wide">
          {{ currentSlideIndex + 1 }} / {{ featuredListings.length }}
        </div>
      </div>

      <!-- RIGHT: Content Area (45% width) -->
      <div class="w-full md:w-[45%] p-6 flex flex-col justify-center relative bg-white">
        
        <!-- Tag -->
        <div class="mb-2">
          <span class="bg-indigo-50 text-indigo-700 px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wider">
            {{ featuredListings[currentSlideIndex].type }}
          </span>
        </div>

        <!-- Title -->
        <h3 class="text-xl md:text-2xl font-bold text-slate-900 leading-tight mb-2">
          {{ featuredListings[currentSlideIndex].title }}
        </h3>

        <!-- Location -->
        <div class="flex items-center text-slate-500 mb-3">
          <span class="material-icons text-indigo-500 text-base mr-1">location_on</span>
          <span class="text-sm font-medium">{{ featuredListings[currentSlideIndex].location }}</span>
        </div>

        <!-- Description (Truncated) -->
        <p class="text-slate-600 text-sm leading-relaxed mb-4 line-clamp-2">
          {{ featuredListings[currentSlideIndex].description }}
        </p>

        <!-- Price & Action -->
        <div class="mt-auto">
          <div class="flex items-baseline mb-3">
            <span class="text-2xl font-bold text-slate-900">â‚¹{{ featuredListings[currentSlideIndex].price }}</span>
            <span class="text-slate-400 text-sm font-medium ml-1">/ month</span>
          </div>

          <div class="grid grid-cols-2 gap-2">
            <a [routerLink]="['/details', featuredListings[currentSlideIndex].id]" 
               class="flex items-center justify-center bg-slate-900 hover:bg-slate-800 text-white font-semibold py-2 rounded-lg transition-all text-sm">
              View Details
            </a>
            <button 
              (click)="toggleFeaturedFav()"
              class="flex items-center justify-center border font-semibold py-2 rounded-lg transition-all text-sm gap-1"
              [ngClass]="isFeaturedFavorite() ? 'border-red-400 bg-red-50 text-red-500' : 'border-slate-200 hover:border-red-400 hover:bg-red-50 text-slate-600 hover:text-red-500'">
              <span class="material-icons text-sm">{{ isFeaturedFavorite() ? 'favorite' : 'favorite_border' }}</span>
              {{ isFeaturedFavorite() ? 'Saved' : 'Save' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================== -->
  <!-- 2. SEARCH & LISTINGS GRID                -->
  <!-- ========================================== -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-16">
    
    <!-- Header & Search -->
    <div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
      <div>
        <h2 class="text-2xl font-bold text-slate-800">Latest Properties</h2>
        <p class="text-slate-500 mt-1">{{ filteredListings.length }} available listings</p>
      </div>

      <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
        <!-- Sort Dropdown -->
        <div class="relative">
          <select 
            [(ngModel)]="sortBy" 
            (change)="onSortChange()"
            class="appearance-none w-full sm:w-48 px-4 py-3 pr-10 border border-gray-200 rounded-xl bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-shadow shadow-sm cursor-pointer">
            <option value="newest">Newest First</option>
            <option value="price-asc">Price: Low to High</option>
            <option value="price-desc">Price: High to Low</option>
            <option value="title">Title (A-Z)</option>
            <option value="type">Type</option>
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <span class="material-icons text-gray-400 text-sm">expand_more</span>
          </div>
        </div>

        <!-- Modern Search Input -->
        <div class="relative w-full sm:w-80 group">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <span class="material-icons text-gray-400 group-focus-within:text-indigo-500 transition-colors">search</span>
          </div>
          <input 
            type="text" 
            [(ngModel)]="searchTerm" 
            (input)="filterListings()"
            class="block w-full pl-10 pr-3 py-3 border border-gray-200 rounded-xl leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-shadow shadow-sm" 
            placeholder="City, Zip, or Address..."
          >
        </div>
      </div>
    </div>

    <!-- Grid Layout -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" *ngIf="paginatedListings.length > 0; else noData">
      <app-listing-card 
        *ngFor="let item of paginatedListings" 
        [listing]="item"
        class="h-full">
      </app-listing-card>
    </div>

    <!-- Pagination Controls -->
    <div class="mt-12 flex flex-col sm:flex-row items-center justify-between gap-4" *ngIf="totalPages > 1">
      <!-- Page Info -->
      <div class="text-sm text-slate-600">
        Showing <span class="font-semibold">{{ (currentPage - 1) * itemsPerPage + 1 }}</span> to 
        <span class="font-semibold">{{ Math.min(currentPage * itemsPerPage, filteredListings.length) }}</span> of 
        <span class="font-semibold">{{ filteredListings.length }}</span> results
      </div>

      <!-- Page Buttons -->
      <div class="flex items-center gap-2">
        <!-- Previous Button -->
        <button 
          (click)="prevPage()" 
          [disabled]="currentPage === 1"
          class="px-4 py-2 rounded-lg border transition-all font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed"
          [ngClass]="currentPage === 1 ? 'border-gray-200 text-gray-400' : 'border-gray-300 text-slate-700 hover:bg-gray-50'">
          <span class="material-icons text-sm align-middle">chevron_left</span>
          Previous
        </button>

        <!-- Page Numbers -->
        <div class="hidden sm:flex gap-1">
          <button 
            *ngFor="let page of getPageNumbers()" 
            (click)="goToPage(page)"
            class="w-10 h-10 rounded-lg font-medium text-sm transition-all"
            [ngClass]="page === currentPage ? 'bg-indigo-600 text-white shadow-md' : 'bg-white border border-gray-200 text-slate-700 hover:bg-gray-50'">
            {{ page }}
          </button>
        </div>

        <!-- Current Page (Mobile) -->
        <div class="sm:hidden px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium text-sm">
          {{ currentPage }} / {{ totalPages }}
        </div>

        <!-- Next Button -->
        <button 
          (click)="nextPage()" 
          [disabled]="currentPage === totalPages"
          class="px-4 py-2 rounded-lg border transition-all font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed"
          [ngClass]="currentPage === totalPages ? 'border-gray-200 text-gray-400' : 'border-gray-300 text-slate-700 hover:bg-gray-50'">
          Next
          <span class="material-icons text-sm align-middle">chevron_right</span>
        </button>
      </div>
    </div>

    <!-- Empty State -->
    <ng-template #noData>
      <div class="flex flex-col items-center justify-center py-24 bg-white rounded-2xl border border-gray-100 shadow-sm text-center">
        <div class="bg-gray-50 p-4 rounded-full mb-4">
          <span class="material-icons text-gray-400 text-4xl">search_off</span>
        </div>
        <h3 class="text-lg font-medium text-gray-900">No matches found</h3>
        <p class="text-gray-500 mt-2 max-w-sm">We couldn't find any properties matching "{{ searchTerm }}". Try checking for typos or use broader keywords.</p>
        <button (click)="searchTerm = ''; filterListings()" class="mt-6 text-indigo-600 font-medium hover:text-indigo-800 hover:underline">
          Clear Search
        </button>
      </div>
    </ng-template>

  </div>
</div>