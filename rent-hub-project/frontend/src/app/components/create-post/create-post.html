<div class="min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8 font-sans">
  
  <!-- ============================================== -->
  <!-- FORM VIEW -->
  <!-- ============================================== -->
  <div *ngIf="!showPreview" class="max-w-4xl mx-auto">
    
    <!-- Header -->
    <div class="text-center mb-10">
      <h1 class="text-4xl font-extrabold text-slate-900 tracking-tight">List Your Property</h1>
      <p class="text-slate-500 mt-2 text-lg">Reach thousands of tenants in a few clicks.</p>
    </div>

    <form [formGroup]="postForm" class="space-y-8">
      
      <!-- CARD 1: Basic Info -->
      <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8">
        <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
          <span class="bg-indigo-100 text-indigo-600 p-2 rounded-lg material-icons text-sm">home</span>
          Property Details
        </h2>

        <div class="space-y-6">
          <!-- Title Input -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">Listing Title</label>
            <input formControlName="title" type="text" class="w-full px-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none" placeholder="e.g. Sunny Apartment in Downtown">
            
            <!-- Validation Errors -->
            <div *ngIf="postForm.get('title')?.invalid && postForm.get('title')?.touched" class="mt-1 text-xs text-red-500 flex items-center gap-1">
              <span class="material-icons text-xs">error</span>
              <span *ngIf="postForm.get('title')?.errors?.['required']">Title is required.</span>
              <span *ngIf="postForm.get('title')?.errors?.['startsWithLetter']">Title must start with a letter (A-Z).</span>
              <span *ngIf="postForm.get('title')?.errors?.['minlength']">Must be at least 5 characters.</span>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Type Select -->
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">Property Type</label>
              <div class="relative">
                <select formControlName="type" class="w-full px-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer">
                  <option value="Apartment">Apartment</option>
                  <option value="Studio">Studio</option>
                  <option value="Villa">Villa</option>
                  <option value="House">Independent House</option>
                </select>
                <span class="material-icons absolute right-4 top-3.5 text-gray-400 pointer-events-none">expand_more</span>
              </div>
            </div>

            <!-- Price Input -->
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">Monthly Rent (rupees)</label>
              <div class="relative">
                <span class="absolute left-4 top-3.5 text-gray-400 font-bold">₹</span>
                <input formControlName="price" type="number" class="w-full pl-8 pr-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none" placeholder="2500">
              </div>
              <small *ngIf="postForm.get('price')?.invalid && postForm.get('price')?.dirty" class="text-red-500 text-xs">Valid price required.</small>
            </div>
          </div>

          <!-- Location Details -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">Location Details</label>
            
            <!-- City/Area -->
            <div class="relative mb-3">
              <span class="material-icons absolute left-4 top-3.5 text-gray-400 text-sm">location_city</span>
              <input formControlName="location" type="text" 
                class="w-full pl-10 pr-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none" 
                placeholder="City or Area (e.g.,Gurgaon)"
                [class.border-red-500]="postForm.get('location')?.invalid && postForm.get('location')?.dirty">
              <small *ngIf="postForm.get('location')?.invalid && postForm.get('location')?.dirty" class="text-red-500 text-xs">City/Area is required.</small>
            </div>

            <!-- State -->
            <div class="relative mb-3">
              <span class="material-icons absolute left-4 top-3.5 text-gray-400 text-sm">map</span>
              <input formControlName="state" type="text" 
                class="w-full pl-10 pr-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none" 
                placeholder="State (e.g. Delhi)"
                [class.border-red-500]="postForm.get('state')?.invalid && postForm.get('state')?.dirty">
              <small *ngIf="postForm.get('state')?.invalid && postForm.get('state')?.dirty" class="text-red-500 text-xs">State is required.</small>
            </div>

            <!-- Pincode -->
            <div class="relative">
              <span class="material-icons absolute left-4 top-3.5 text-gray-400 text-sm">pin_drop</span>
              <input formControlName="pincode" type="text" maxlength="6"
                class="w-full pl-10 pr-5 py-3 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none" 
                placeholder="Pincode (6 digits)"
                [class.border-red-500]="postForm.get('pincode')?.invalid && postForm.get('pincode')?.dirty">
              <small *ngIf="postForm.get('pincode')?.invalid && postForm.get('pincode')?.dirty" class="text-red-500 text-xs">
                <span *ngIf="postForm.get('pincode')?.errors?.['required']">Pincode is required.</span>
                <span *ngIf="postForm.get('pincode')?.errors?.['pattern']">Pincode must be exactly 6 digits.</span>
              </small>
            </div>
          </div>
        </div>
      </div>

      <!-- CARD 2: Features & Preferences (Trendy Selection Cards) -->
      <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8">
        <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
          <span class="bg-indigo-100 text-indigo-600 p-2 rounded-lg material-icons text-sm">settings</span>
          Features & Rules
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          
          <!-- Furnished Radio Group -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-3">Is it Furnished?</label>
            <div class="flex gap-4">
              <label class="flex-1 cursor-pointer">
                <input type="radio" formControlName="furnished" value="Yes" class="peer sr-only">
                <div class="border-2 border-gray-100 rounded-xl p-4 text-center hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50 transition-all">
                  <span class="block font-bold text-slate-700 peer-checked:text-indigo-700">Yes</span>
                </div>
              </label>
              <label class="flex-1 cursor-pointer">
                <input type="radio" formControlName="furnished" value="No" class="peer sr-only">
                <div class="border-2 border-gray-100 rounded-xl p-4 text-center hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50 transition-all">
                  <span class="block font-bold text-slate-700 peer-checked:text-indigo-700">No</span>
                </div>
              </label>
            </div>
          </div>

          <!-- Vegetarian Radio Group -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-3">Vegetarian Only?</label>
            <div class="flex gap-4">
              <label class="flex-1 cursor-pointer">
                <input type="radio" formControlName="vegetarian" value="Yes" class="peer sr-only">
                <div class="border-2 border-gray-100 rounded-xl p-4 text-center hover:border-green-200 peer-checked:border-green-600 peer-checked:bg-green-50 transition-all">
                  <span class="block font-bold text-slate-700 peer-checked:text-green-700">Yes</span>
                </div>
              </label>
              <label class="flex-1 cursor-pointer">
                <input type="radio" formControlName="vegetarian" value="No" class="peer sr-only">
                <div class="border-2 border-gray-100 rounded-xl p-4 text-center hover:border-red-400 peer-checked:border-red-600 peer-checked:bg-red-50 transition-all">
                  <span class="block font-bold text-slate-700 peer-checked:text-red-700">No</span>
                </div>
              </label>
            </div>
          </div>

        </div>
      </div>

      <!-- CARD 3: Amenities (Chip Style) -->
      <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8">
        <h2 class="text-xl font-bold text-slate-800 mb-6">Amenities Included</h2>
        <div class="flex flex-wrap gap-3">
          <label *ngFor="let option of amenityOptions" class="cursor-pointer">
            <input type="checkbox" [value]="option.value" (change)="onCheckboxChange($event)" class="sr-only">
            <div 
              class="px-4 py-2 rounded-full border text-sm font-medium transition-all flex items-center gap-2"
              [ngClass]="isAmenitySelected(option.value) ? 'bg-indigo-600 border-indigo-600 text-white shadow-md' : 'bg-white border-gray-200 text-gray-600 hover:border-indigo-300'"
            >
              <span class="material-icons text-sm" *ngIf="option.icon">{{ option.icon }}</span>
              {{ option.name }}
            </div>
          </label>
        </div>
      </div>

      <!-- CARD 4: Description & Image Upload -->
      <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8">
        <h2 class="text-xl font-bold text-slate-800 mb-6">More Details</h2>
        <textarea formControlName="description" rows="5" class="w-full px-5 py-4 rounded-xl bg-gray-50 border-gray-200 border focus:bg-white focus:ring-2 focus:ring-indigo-500 transition-all outline-none resize-none" placeholder="Describe the ambiance, nearby places, etc..."></textarea>
        <small class="text-gray-400 text-xs block mt-2 text-right">Min 10 characters</small>
        
        <!-- Image Upload Section -->
        <div class="mt-6">
          <label class="block text-sm font-semibold text-slate-700 mb-3">Property Image</label>
          
          <!-- Upload Area (shown when no image) -->
          <div *ngIf="!imagePreview && !isUploading" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-colors cursor-pointer bg-gray-50"
               (click)="fileInput.click()">
            <input #fileInput type="file" accept="image/*" (change)="onImageUpload($event)" class="hidden">
            <span class="material-icons text-4xl text-gray-400 mb-2 block">cloud_upload</span>
            <p class="text-gray-600 font-medium">Click to upload image</p>
            <p class="text-gray-400 text-sm mt-1">JPEG, PNG, GIF or WebP (Max 5MB)</p>
          </div>

          <!-- Loading State -->
          <div *ngIf="isUploading" class="border-2 border-dashed border-indigo-300 rounded-xl p-8 text-center bg-indigo-50">
            <div class="animate-spin material-icons text-4xl text-indigo-600 mb-2">cloud_upload</div>
            <p class="text-indigo-600 font-medium">Uploading image...</p>
          </div>

          <!-- Image Preview (shown when image uploaded) -->
          <div *ngIf="imagePreview && !isUploading" class="relative rounded-xl overflow-hidden">
            <img [src]="imagePreview" alt="Preview" class="w-full h-64 object-cover rounded-xl">
            <button type="button" (click)="removeImage()" 
                    class="absolute top-3 right-3 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full shadow-lg transition-colors flex">
              <span class="material-icons text-sm">close</span>
            </button>
            <div class="absolute bottom-3 left-3 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1">
              <span class="material-icons text-sm">check_circle</span>
              Image uploaded 
            </div>
          </div>

          <!-- Validation Error -->
          <div *ngIf="postForm.get('image')?.invalid && postForm.get('image')?.touched" class="mt-2 text-xs text-red-500 flex items-center gap-1">
            <span class="material-icons text-xs">error</span>
            Please upload a property image.
          </div>
        </div>
      </div>

      <!-- Action -->
      <div class="flex justify-end pt-4 pb-20">
        <button (click)="togglePreview()" class="bg-slate-900 hover:bg-black text-white px-8 py-4 rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all flex items-center gap-2">
          Proceed to Preview <span class="material-icons">arrow_forward</span>
        </button>
      </div>

    </form>
  </div>

    <!-- ============================================== -->
    <!-- PREVIEW VIEW -->
    <!-- ============================================== --> 
  <div *ngIf="showPreview" class="max-w-4xl mx-auto animate-fade-in">
    
    <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-slate-800">Preview Your Listing</h2>
      <p class="text-slate-500">This is how it will appear to potential tenants.</p>
    </div>

    <!-- Preview Card (Matches Home Design) -->
    <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-gray-100 mb-8">
      <div class="grid grid-cols-1 md:grid-cols-2">
        <div class="h-64 md:h-auto bg-gray-200 relative">
           <img [src]="postForm.get('image')?.value" class="w-full h-full object-cover">
           <div class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider text-indigo-800">
             {{ postForm.get('type')?.value }}
           </div>
        </div>
        
        <div class="p-8 md:p-10 flex flex-col justify-center">
            <div class="flex justify-between items-start mb-4">
              <h1 class="text-2xl md:text-3xl font-bold text-slate-900 leading-tight">{{ postForm.get('title')?.value }}</h1>
            </div>

            <div class="text-3xl font-bold text-slate-900 mb-2">₹{{ postForm.get('price')?.value }}<span class="text-sm font-medium text-gray-400">/mo</span></div>
            
            <div class="flex items-center text-slate-500 mb-6 text-sm font-medium">
                <span class="material-icons text-indigo-500 text-lg mr-2">location_on</span> 
                {{ postForm.get('location')?.value }}, {{ postForm.get('state')?.value }} - {{ postForm.get('pincode')?.value }}
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-2 gap-4 mb-6 text-sm text-slate-600 bg-gray-50 p-4 rounded-xl">
               <div>
                 <span class="block text-xs text-gray-400 uppercase font-bold">Furnished</span>
                 <span class="font-semibold">{{ postForm.get('furnished')?.value }}</span>
               </div>
               <div>
                 <span class="block text-xs text-gray-400 uppercase font-bold">Vegetarian</span>
                 <span class="font-semibold">{{ postForm.get('vegetarian')?.value }}</span>
               </div>
            </div>

            <p class="text-slate-600 leading-relaxed text-sm mb-6">{{ postForm.get('description')?.value }}</p>

            <div class="flex flex-wrap gap-2">
               <span *ngFor="let am of postForm.get('amenities')?.value" class="text-xs bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full border border-indigo-100 font-medium">
                 {{ am }}
               </span>
            </div>
        </div>
      </div>
    </div>

    <!-- Preview Actions -->
    <div class="grid grid-cols-2 gap-4">
      <button (click)="togglePreview()" class="py-4 rounded-xl border-2 border-gray-200 text-gray-600 font-bold hover:bg-gray-50 transition-colors">
        Edit Details
      </button>
      <button (click)="onSubmit()" class="py-4 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-bold shadow-lg hover:shadow-indigo-200 transition-all flex justify-center items-center gap-2">
        Publish Listing <span class="material-icons">check</span>
      </button>
    </div>

  </div>

</div>